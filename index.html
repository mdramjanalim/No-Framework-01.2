<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Book 2026 | Ultimate Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Poppins:wght@300;400;600;700&display=swap');

        :root {
            --primary: #4f46e5;
            --secondary: #9333ea;
            --glass: rgba(255, 255, 255, 0.9);
        }

        body {
            font-family: 'Poppins', 'Hind Siliguri', sans-serif;
            background: #f8fafc;
            overflow-x: hidden;
        }

        .neo-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .neo-card:active { transform: scale(0.97); }

        .search-container {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 0 0 40px 40px;
        }

        .loader-spin {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 20px;
            height: 20px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .modal-active { display: flex !important; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .category-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body class="bg-slate-50">

    <!-- App Header & Search -->
    <div class="search-container pb-12 pt-8 px-6 text-white relative">
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold tracking-tight">Word Book 2026</h1>
                <p class="opacity-80 text-sm">১০,০০০+ শব্দের স্মার্ট ডিকশনারি</p>
            </div>
            <div class="bg-white/20 p-3 rounded-2xl">
                <i class="fas fa-microchip text-xl"></i>
            </div>
        </div>

        <div class="relative group">
            <input type="text" id="searchInput" 
                placeholder="ইংরেজি শব্দ লিখুন (যেমন: Adventure)..." 
                class="w-full py-5 px-6 rounded-2xl bg-white text-slate-800 shadow-2xl focus:outline-none text-lg">
            <button onclick="performSmartSearch()" id="searchBtn"
                class="absolute right-2 top-2 bottom-2 bg-indigo-600 px-6 rounded-xl hover:bg-indigo-700 transition flex items-center space-x-2">
                <span id="btnText">সার্চ</span>
                <div id="loader" class="loader-spin hidden"></div>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="px-6 -mt-6">
        
        <!-- Word of the Day -->
        <div class="bg-white p-6 rounded-3xl shadow-xl flex items-center justify-between mb-8">
            <div>
                <span class="text-xs font-bold text-indigo-500 uppercase tracking-widest">আজকের শব্দ</span>
                <h2 class="text-2xl font-bold text-slate-800" id="dailyWordEn">Resilience</h2>
                <p class="text-slate-500" id="dailyWordBn">সহনশীলতা / স্থিতিস্থাপকতা</p>
            </div>
            <button onclick="speak('Resilience')" class="bg-indigo-50 text-indigo-600 p-4 rounded-2xl hover:bg-indigo-600 hover:text-white transition">
                <i class="fas fa-volume-up text-xl"></i>
            </button>
        </div>

        <!-- 20 Categories Section -->
        <h3 class="text-xl font-bold text-slate-800 mb-4">ক্যাটাগরি সমূহ (২০টি)</h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10" id="categoryGrid">
            <!-- JS will inject 20 categories -->
        </div>

    </main>

    <!-- Word Detail Modal -->
    <div id="resultModal" class="fixed inset-0 z-50 bg-slate-900/80 backdrop-blur-md hidden flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl">
            <div class="p-8 text-center border-b border-slate-100">
                <div class="flex justify-end">
                    <button onclick="closeModal()" class="text-slate-400 hover:text-slate-600"><i class="fas fa-times-circle text-2xl"></i></button>
                </div>
                <h2 id="resEn" class="text-5xl font-black text-slate-800 mb-2">Word</h2>
                <div id="resPr" class="text-indigo-500 font-mono mb-4 text-sm tracking-widest">/pronunciation/</div>
                <div class="inline-block px-4 py-1 rounded-full bg-slate-100 text-slate-500 text-xs font-bold uppercase" id="resPs">Noun</div>
            </div>
            <div class="p-8 bg-slate-50">
                <div class="mb-6">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-2">বাংলা অর্থ</label>
                    <p id="resBn" class="text-3xl font-bold text-indigo-600">অর্থ লোড হচ্ছে...</p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="modalSpeak()" class="flex flex-col items-center justify-center p-4 bg-white rounded-3xl shadow-sm border border-slate-100 hover:bg-indigo-600 hover:text-white transition group">
                        <i class="fas fa-volume-up text-xl mb-2 text-indigo-600 group-hover:text-white"></i>
                        <span class="text-xs font-bold">উচ্চারণ</span>
                    </button>
                    <button class="flex flex-col items-center justify-center p-4 bg-white rounded-3xl shadow-sm border border-slate-100 hover:bg-indigo-600 hover:text-white transition group">
                        <i class="fas fa-bookmark text-xl mb-2 text-indigo-600 group-hover:text-white"></i>
                        <span class="text-xs font-bold">সংরক্ষণ</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Toast -->
    <div id="errorToast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-red-600 text-white px-6 py-3 rounded-2xl shadow-2xl hidden z-[100] animate-bounce">
        <i class="fas fa-exclamation-triangle mr-2"></i> কিছু একটা ভুল হয়েছে! আবার চেষ্টা করুন।
    </div>

    <script>
        const apiKey = "AIzaSyCjQyFDOJsde6moDaiz35n3thKPAjS7gZk"; // Runtime provides this

        const categories = [
            { id: 1, name: "মানবদেহ", icon: "fa-user-alt", color: "bg-blue-100 text-blue-600" },
            { id: 2, name: "শিক্ষাপ্রতিষ্ঠান", icon: "fa-school", color: "bg-indigo-100 text-indigo-600" },
            { id: 3, name: "পাখপাখালি", icon: "fa-dove", color: "bg-emerald-100 text-emerald-600" },
            { id: 4, name: "ফুল", icon: "fa-seedling", color: "bg-pink-100 text-pink-600" },
            { id: 5, name: "ফলমূল", icon: "fa-apple-alt", color: "bg-orange-100 text-orange-600" },
            { id: 6, name: "প্রযুক্তি", icon: "fa-microchip", color: "bg-slate-100 text-slate-600" },
            { id: 7, name: "পশুপাখি", icon: "fa-paw", color: "bg-amber-100 text-amber-600" },
            { id: 8, name: "পরিবেশ", icon: "fa-leaf", color: "bg-green-100 text-green-600" },
            { id: 9, name: "মহাকাশ", icon: "fa-rocket", color: "bg-purple-100 text-purple-600" },
            { id: 10, name: "চিকিৎসা", icon: "fa-stethoscope", color: "bg-red-100 text-red-600" },
            { id: 11, name: "রান্নাঘর", icon: "fa-utensils", color: "bg-yellow-100 text-yellow-600" },
            { id: 12, name: "ব্যবসা", icon: "fa-briefcase", color: "bg-cyan-100 text-cyan-600" },
            { id: 13, name: "আইন", icon: "fa-gavel", color: "bg-stone-100 text-stone-600" },
            { id: 14, name: "খেলাধুলা", icon: "fa-running", color: "bg-lime-100 text-lime-600" },
            { id: 15, name: "সঙ্গীত", icon: "fa-music", color: "bg-violet-100 text-violet-600" },
            { id: 16, name: "পরিবার", icon: "fa-users", color: "bg-teal-100 text-teal-600" },
            { id: 17, name: "যানবাহন", icon: "fa-car", color: "bg-rose-100 text-rose-600" },
            { id: 18, name: "আবহাওয়া", icon: "fa-cloud-sun", color: "bg-sky-100 text-sky-600" },
            { id: 19, name: "আবেগ", icon: "fa-grin-hearts", color: "bg-fuchsia-100 text-fuchsia-600" },
            { id: 20, name: "সময় ও তারিখ", icon: "fa-clock", color: "bg-gray-100 text-gray-600" }
        ];

        // Initialize App
        function init() {
            const grid = document.getElementById('categoryGrid');
            categories.forEach(cat => {
                const card = document.createElement('div');
                card.className = "neo-card p-5 flex flex-col items-center justify-center cursor-pointer";
                card.onclick = () => {
                    document.getElementById('searchInput').value = cat.name;
                    performSmartSearch();
                };
                card.innerHTML = `
                    <div class="category-icon ${cat.color}">
                        <i class="fas ${cat.icon} text-xl"></i>
                    </div>
                    <span class="text-xs font-bold text-slate-700">${cat.name}</span>
                `;
                grid.appendChild(card);
            });
        }

        // Smart Search with AI & Logic
        async function performSmartSearch() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) return;

            const loader = document.getElementById('loader');
            const btnText = document.getElementById('btnText');
            
            // UI State: Loading
            loader.classList.remove('hidden');
            btnText.classList.add('hidden');

            const systemPrompt = `You are a professional English-to-Bengali Dictionary. 
            For the word provided, return a JSON object with:
            { "en": "word", "bn": "meaning in bengali", "pr": "IPA pronunciation", "ps": "part of speech" }.
            If the query is a category, return a list of 5 important words related to it in the same JSON format within an array called "words".`;

            let retries = 0;
            const maxRetries = 5;
            
            const makeRequest = async () => {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Translate and define: ${query}` }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });
                if (!response.ok) throw new Error('API Error');
                return response.json();
            };

            try {
                // Exponential Backoff Implementation
                const executeWithRetry = async (attempt) => {
                    try {
                        return await makeRequest();
                    } catch (err) {
                        if (attempt < maxRetries) {
                            const delay = Math.pow(2, attempt) * 1000;
                            await new Promise(res => setTimeout(res, delay));
                            return executeWithRetry(attempt + 1);
                        }
                        throw err;
                    }
                };

                const data = await executeWithRetry(0);
                const result = JSON.parse(data.candidates[0].content.parts[0].text);
                
                if (result.words) {
                    // It returned a category list
                    showWordDetail(result.words[0]); 
                } else {
                    showWordDetail(result);
                }

            } catch (error) {
                console.error(error);
                showError();
            } finally {
                loader.classList.add('hidden');
                btnText.classList.remove('hidden');
            }
        }

        function showWordDetail(word) {
            document.getElementById('resEn').innerText = word.en;
            document.getElementById('resBn').innerText = word.bn;
            document.getElementById('resPr').innerText = word.pr || '/.../';
            document.getElementById('resPs').innerText = word.ps || 'Word';
            document.getElementById('resultModal').classList.add('modal-active');
        }

        function closeModal() {
            document.getElementById('resultModal').classList.remove('modal-active');
        }

        function showError() {
            const toast = document.getElementById('errorToast');
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 3000);
        }

        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.8;
            window.speechSynthesis.speak(utterance);
        }

        function modalSpeak() {
            const text = document.getElementById('resEn').innerText;
            speak(text);
        }

        // Search on Enter key
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSmartSearch();
        });

        window.onload = init;
    </script>
</body>
</html>

